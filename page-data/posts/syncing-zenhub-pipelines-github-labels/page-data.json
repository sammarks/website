{"componentChunkName":"component---src-templates-page-tsx","path":"/posts/syncing-zenhub-pipelines-github-labels/","result":{"data":{"markdownRemark":{"parent":{"__typename":"File","relativePath":"posts/syncing-zenhub-pipelines-github-labels.md","fields":{"gitLogLatestDate":"August 12, 2020"}},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"div","properties":{"className":["custom-block","block-point"]},"children":[{"type":"element","tagName":"div","properties":{"className":["custom-block-heading"]},"children":[{"type":"text","value":"What’s the point?"}]},{"type":"element","tagName":"div","properties":{"className":["custom-block-body"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://zenhub.com","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"ZenHub"}]},{"type":"text","value":" doesn’t support syncing pipeline status back to Github labels by\ndefault. Since you might require this functionality in your project management workflow, they\nprovide an API allowing you to do it yourself."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ZenHub is missing one key feature in my humble opinion: the ability to sync the ZenHub “status” back\nwith Github. By this I mean the ZenHub-specific features that Github does not yet have, like the\ncurrent pipeline of an issue."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"But who would use this?"}]},{"type":"text","value":" "},{"type":"element","tagName":"a","properties":{"href":"../automatically-syncing-github-issues-google-sheets/"},"children":[{"type":"text","value":"In another\narticle,"}]},{"type":"text","value":" I wrote about being able to sync\nGithub issues with Google Sheets in order to run some reporting on that data to share with other\nstakeholders in the company. "},{"type":"element","tagName":"a","properties":{"href":"../adding-zenhub-estimates-to-google-sheets/"},"children":[{"type":"text","value":"I also wrote"}]},{"type":"text","value":" about how\nto pull in the current ZenHub estimate into Google Sheets, and noted in that article that ZenHub API\nlimits are pretty low, so you’ll frequently run into them when working with a large(ish) amount of\nissues."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I needed to sync the current ZenHub pipeline with that sheet in order to provide more specific\nreporting, but was aware of this issue with API limits and thought it wouldn’t work very well. So I\narrived at this solution! Just sync the current pipeline (only the ones I’m interested in) back with\nGithub through labels, and then sync those labels to Google Sheets using the script I’ve already\nwritten."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So that’s what we’ll do here. Let’s get started:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"github","properties":{},"children":[{"type":"text","value":"sammarks/cloudformation-zenhub-github-label"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Setting up the stack"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"First things first, let’s make sure you have a Github token ready for use. If you followed along\nwith my article on syncing Github issues with Google Sheets, you’ll already have one handy. If not,\nno worries. Head to Github, then go to "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Settings → Developer Settings → Personal Access Tokens"}]},{"type":"text","value":"\nand generate yourself a new access token. Make sure to enable the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"repo"}]},{"type":"text","value":" permission, and that’s all\nwe really need. Keep this handy, because we’ll be needing it later."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["custom-block","block-warning"]},"children":[{"type":"element","tagName":"div","properties":{"className":["custom-block-heading"]},"children":[{"type":"element","tagName":"icon-warning","properties":{},"children":[{"type":"text","value":"Vendor Lock-in Warning!"}]}]},{"type":"element","tagName":"div","properties":{"className":["custom-block-body"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This repository was created (and this blog post was written) with AWS CloudFormation in mind, so\nall dependencies will be deployed through AWS. I might have a need to create a Docker-based\nalternative in the future, but in the meantime a PR is welcome if you tackle the issue yourself."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s get started with the AWS template. Go ahead and "},{"type":"element","tagName":"a","properties":{"href":"https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=zenhub-github-label&templateURL=https://sammarks-cf-templates.s3.amazonaws.com/zenhub-github-label/template.yaml","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"click this\nlink"}]},{"type":"text","value":"\nto launch a new CloudFormation template with the code we need. Once you do, you’ll be taken to AWS.\nEverything is already filled in for you on the first step, so go ahead and immediately click\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Next."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Give your stack a funky-fresh original name at the top, and then let’s check out our parameters.\nWe’ve got a debug parameter, a place for our Github token, and a place to specify which pipelines to\nuse."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For the debug parameter, if you want to enable debug mode (it creates a decent amount of log entries\nso be careful not to have it on all the time), just put "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"cloudformation-zenhub-github-label"}]},{"type":"text","value":" in this\nfield."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For the Github token parameter, paste in the Github token you created (or already had written down)\nearlier."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Finally, the pipelines parameter is special. Put a comma-separated list of the pipeline names you\nwant to “watch.” If a pipeline is “watched,” any time an issue moves into the pipeline, a Github\nlabel is created with a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:"}]},{"type":"text","value":" prefix indicating the pipeline the issue is currently in. When the\nissue moves out of that pipeline, the label is removed."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So let’s go through an example. You’ve got three pipelines: Todo, Working, and Done. In this\nparameter, you’ve provided “Todo,Working” as the value. Here’s what happens:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"If you create an issue and put it in the Todo pipeline, this script will create a label called\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:Todo"}]},{"type":"text","value":" and add it to the issue."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"If you move that issue to the Working pipeline, the script will remove the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:Todo"}]},{"type":"text","value":" label, create\na new one called "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:Working"}]},{"type":"text","value":" and attach it to the issue."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Finally, if you move it from Working to Done, the script will remove the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:Working"}]},{"type":"text","value":" label. It\nwill "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"not"}]},{"type":"text","value":" create a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zh:Done"}]},{"type":"text","value":" label because you didn’t include “Done” in the list of pipelines\nto watch."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With all that out of the way, hit "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Next"}]},{"type":"text","value":" at the bottom-right corner of the page. Here you can add\nsome extra tags or any other information to your stack, but nothing here is required so let’s hit\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Next"}]},{"type":"text","value":" again at the bottom."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Again, nothing super important on this page; just reviewing the stuff we’re about to create. Check\nthe three boxes inside the blue box at the bottom of the page, and then click "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Create stack."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Wait a few minutes for the magic to happen, and then we’ll setup our connection with ZenHub!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Connecting to ZenHub"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we’ve got a stack deployed! But there’s a rub: we don’t have any way for ZenHub to "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"tell"}]},{"type":"text","value":" the\nstack that an issue has moved to another pipeline."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Thankfully, ZenHub has support for Webhooks inside their API! The stack we just created has an\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Output"}]},{"type":"text","value":" that contains the API Gateway endpoint we’re going to give to ZenHub as the webhook\nendpoint."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["custom-block","block-info"]},"children":[{"type":"element","tagName":"div","properties":{"className":["custom-block-heading"]},"children":[{"type":"element","tagName":"icon-info","properties":{},"children":[{"type":"text","value":"What’s an output?"}]}]},{"type":"element","tagName":"div","properties":{"className":["custom-block-body"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An output is a way to "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"retrieve"}]},{"type":"text","value":" information from CloudFormation. Normally they’re used so stacks\ncan communicate with one another, but I found it to be a nice and easy way to have the API\nGateway endpoint printed exactly how we should be giving it to ZenHub."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To get our output, go to the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Outputs"}]},{"type":"text","value":" tab toward the top of the page when viewing your stack.\nThere should be one output listed: “APIEndpoint”"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Copy the link inside the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Value"}]},{"type":"text","value":" column to your clipboard, we’ll be needing that in a minute."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now, head to ZenHub. Click on your account in the bottom-left corner of the screen, and then click\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Manage Organizations"}]},{"type":"text","value":" in the pop-up menu. On the page you should have been taken to, click on\n"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Slack & Integrations"}]},{"type":"text","value":" in the left-hand sidebar."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Under the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Integrations"}]},{"type":"text","value":" section, inside the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Select the service:"}]},{"type":"text","value":" field, select "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Custom."}]},{"type":"text","value":"\nThen, search for the name of the repository containing the issues you want to sync the pipelines\nfor."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["custom-block","block-info"]},"children":[{"type":"element","tagName":"div","properties":{"className":["custom-block-heading"]},"children":[{"type":"element","tagName":"icon-info","properties":{},"children":[{"type":"text","value":"Each integration only supports one repository."}]}]},{"type":"element","tagName":"div","properties":{"className":["custom-block-body"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you have multiple repositories you need to sync, just repeat these steps for each one. You can\nuse the same “APIEndpoint” output for each one as the Lambda function is smart enough to update\nthe correct issue in the correct repository."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Once you’ve got your repository selected, give your integration a nice descriptive name, and then\npaste the “APIEndpoint” value you copied to your clipboard earlier into the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Webhook URL"}]},{"type":"text","value":" field."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Click "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Add Integration"}]},{"type":"text","value":" and you’re good to go!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["custom-block","block-success"]},"children":[{"type":"element","tagName":"div","properties":{"className":["custom-block-heading"]},"children":[{"type":"element","tagName":"icon-success","properties":{},"children":[{"type":"text","value":"You’ve done it!"}]}]},{"type":"element","tagName":"div","properties":{"className":["custom-block-body"]},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You should have a working setup automatically syncing ZenHub pipelines with Github issue labels\n(and hopefully Google Sheets later). Give it a quick test by dragging an issue in between your\npipelines, and in a few seconds you should see the label show up."}]}]}]}],"data":{"quirksMode":false}},"fields":{"slug":"/posts/syncing-zenhub-pipelines-github-labels/","socialImagePath":"/meta-images/posts/syncing-zenhub-pipelines-github-labels.png"},"frontmatter":{"title":"Syncing ZenHub pipelines with Github issue labels","summary":"Automatically sync ZenHub pipelines with Github issue labels using AWS CloudFormation and Lambda.","date":"2020-08-12"}}},"pageContext":{"slug":"/posts/syncing-zenhub-pipelines-github-labels/"}}}